<!DOCTYPE HTML>
<html>

<head>
	<link rel="bookmark"  type="image/x-icon"  href="/img/logo_miccall.png"/>
	<link rel="shortcut icon" href="/img/logo_miccall.png">
	
			    <title>
    Jun
    </title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="/css/mic_main.css" />
    <link rel="stylesheet" href="/css/dropdownMenu.css" />
    <meta name="keywords" content="Jun-bio" />
    
    	<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
	 
    <noscript>
        <link rel="stylesheet" href="/css/noscript.css" />
    </noscript>
    <style type="text/css">
        body:before {
          content: ' ';
          position: fixed;
          top: 0;
          background: url('/img/1.jpg') center 0 no-repeat;
          right: 0;
          bottom: 0;
          left: 0;
          background-size: cover; 
        }
    </style>

			    
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script async type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


    <script src="/js/jquery.min.js"></script>
    <script src="/js/jquery.scrollex.min.js"></script>
    <script src="/js/jquery.scrolly.min.js"></script>
    <script src="/js/skel.min.js"></script>
    <script src="/js/util.js"></script>
    <script src="/js/main.js"></script>
	
	<link rel="stylesheet" href="//cdn.bootcss.com/highlight.js/9.2.0/styles/github.min.css">
	<script src="//cdn.bootcss.com/highlight.js/9.2.0/highlight.min.js"></script>
</head>
    
		
<!-- Layouts -->



<!--  代码渲染  -->
<link rel="stylesheet" href="/css/prism_coy.css" />
<link rel="stylesheet" href="/css/typo.css" />
<!-- 文章页 -->
<body class="is-loading">
    <!-- Wrapper 外包 s-->
    <div id="wrapper" class="fade-in">
        <!-- Intro 头部显示 s -->
        <!-- Intro 头部显示 e -->
        <!-- Header 头部logo start -->
        <header id="header">
    <a href="/" class="logo">Mr Jun</a>
</header>
        <!-- Nav 导航条 start -->
        <nav id="nav" class="special" >
            <ul class="menu links" >
			<!-- Homepage  主页  --> 
			<li >
	            <a href="/" rel="nofollow">主页</a>
	        </li>
			<!-- categories_name  分类   --> 
	        
	        <li class="active">
	            <a href="#s1">分类</a>
	                    <ul class="submenu">
	                        <li>
	                        <a class="category-link" href="/categories/R/">R</a></li><li><a class="category-link" href="/categories/动漫/">动漫</a></li><li><a class="category-link" href="/categories/杂记/">杂记</a></li><li><a class="category-link" href="/categories/生物信息/">生物信息</a>
	                    </ul>
	        </li>
	        
	        <!-- archives  归档   --> 
	        
	        
		        <!-- Pages 自定义   -->
		        
		        <li>
		            <a href="/about/" title="简历">
		                简历
		            </a>
		        </li>
		        
		        <li>
		            <a href="/movie/" title="新世纪补番计划">
		                新世纪补番计划
		            </a>
		        </li>
		        
		        <li>
		            <a href="/tag/" title="标签">
		                标签
		            </a>
		        </li>
		        


            </ul>
            <!-- icons 图标   -->
			<ul class="icons">
                    
                    <li>
                        <a title="github" href="https://github.com/ReJun" target="_blank" rel="noopener">
                            <i class="icon fa fa-github"></i>
                        </a>
                    </li>
                    
                    <li>
                        <a title="500px" href="http://500px.com" target="_blank" rel="noopener">
                            <i class="icon fa fa-500px"></i>
                        </a>
                    </li>
                    
			</ul>
</nav>

        <div id="main" >
            <div class ="post_page_title_img" style="height: 25rem;background-image: url(http://ppd6ez4p8.bkt.clouddn.com/%E6%A3%AE%E6%9E%97.jpg);background-position: center; background-repeat:no-repeat; background-size:cover;-moz-background-size:cover;overflow:hidden;" >
                <a href="#" style="padding: 4rem 4rem 2rem 4rem ;"><h2 >EST序列拼接及分子标记开发</h2></a>
            </div>
            <!-- Post -->
            <div class="typo" style="padding: 3rem;">
                <h1 id="Created-by-Jun-转载请注明出处：Junandhisworld-com"><a href="#Created-by-Jun-转载请注明出处：Junandhisworld-com" class="headerlink" title="Created by Jun (转载请注明出处：Junandhisworld.com)"></a>Created by Jun (转载请注明出处：Junandhisworld.com)</h1><blockquote>
<p><strong>关键词</strong>：<strong>EST序列</strong>、<strong>拼接</strong>、<strong>SSR位点</strong>、<strong>SNP位点</strong>、<strong>CAP3、QualitySNP</strong></p>
<h2 id="Contents"><a href="#Contents" class="headerlink" title="Contents"></a>Contents</h2><ul>
<li>EST序列</li>
<li>SSR标记和SNP位点</li>
<li>序列获取</li>
<li>序列预处理</li>
<li>序列拼接</li>
<li>拼接序列后处理</li>
<li>拼接序列SNP位点检测</li>
<li>拼接序列SSP位点检测</li>
</ul>
</blockquote>
<h2 id="一-EST序列定义"><a href="#一-EST序列定义" class="headerlink" title="一.EST序列定义"></a>一.EST序列定义</h2><p>EST序列，又叫表达序列标签(expressed sequnence tags,ESTs)。广泛应用于基因识别、基因表达图谱的绘制、分子标记开发等领域。<br>EST序列主要来源于mRNA，经过反转录后所构建的CDNA文库。因此EST序列是不含Intron的，其次由于是经过mRNA反转录后，通过测序所得到的序列，所以一定程度上EST序列也可以反映基因的表达水平。</p>
<h2 id="二-SSR位点和SNP位点"><a href="#二-SSR位点和SNP位点" class="headerlink" title="二.SSR位点和SNP位点"></a>二.SSR位点和SNP位点</h2><p>SSR(Simple Sequence Repeats)标记，也称为微卫星DNA，是一类由<strong>几个核苷酸(1~6或10个核苷酸)为重复单位组成的长达</strong>几十个核苷酸的串联重复序列**。广泛分布于高等生物基因组中。</p>
<p>作用：常用于植物育种分子标记、疾病诊断、连锁遗传分析。</p>
<p>注： 由于二代测序技术的兴起,所带来的成本效益和通量。SNP逐渐成为分子标记领域的主要角色。由于SSR位点多存在于重复序列当中，而重复序列相对于二代测序技术来说不易分析。所以通常使用PCR扩增来分析SSR，但这样意味着成本的上升。</p>
<p>SNP(single-nucleotide polymorphism),译为单核苷酸多态性。主要指基因组水平上由单个核苷酸变异所引起的DNA序列多态性。为可遗传变异的一种。包括转换、颠换、缺失、插入，数量非常庞大。</p>
<p>作用：开发分子标记，揭示进化关系，及功能基因挖掘。</p>
<h2 id="三-序列获取"><a href="#三-序列获取" class="headerlink" title="三.序列获取"></a>三.序列获取</h2><p>公共数据库： 序列可以通过NCBI数据库当中的EST子数据库获取。</p>
<h2 id="四-序列预处理"><a href="#四-序列预处理" class="headerlink" title="四.序列预处理"></a>四.序列预处理</h2><p>对于所得EST序列，可能存在测序建库时所包含的：接头引物、污染序列、载体序列等干扰因素。这些因素会严重的影响后续序列的拼接，及所得分子标记的准确性。为了降低背景噪音，需要对EST序列进行预处理(Quality Control)。</p>
<p>我所知的，比较方便的处理方式有两种</p>
<p>通过SeqClean这个程序来对EST序列进行降噪(非常推荐)<br>通过DNAman下的子程序Seqman来对EST序列进行处理。<br>这里我只讲第一种方式。SeqClean处理背景噪音，主要是依托数据库来进行分析。需要构建一个相关的污染序列数据库。NCBI的VecScreen提供了污染序列的数据库。</p>
<p>通过下载后,利用本地Blast中的make blastdb.exe进行格式(formatdb)的转变。</p>
<p><a href="ftp://ftp.ncbi.nlm.nih.gov/pub/UniVec/" target="_blank" rel="external">UniVec</a></p>
<p><strong>SeqClean目前仅支持Linux平台。</strong></p>
<p><strong>使用方法：</strong></p>
<p>Download之后进行解压tar xvzf seqclean.tar.gz<br>seqclean支持EST序列文件以FASTA格式作为输入。<br>使用seqclean your_EST_file<br>seqclean会输出两个结果文件：your_EST_file.clean your_EST_file.cln<br>文件解读：.clean只包含有效的经过处理后的EST序列文件。也就是我们最终所需要的结果。.cln文件则是对EST序列文件的一个处理报告。<br>注意：上述所得到的结果，仅仅是简单的对EST序列进行了基本的处理。包括去除polyA/polyT,低质量的序列，没有针对污染序列做处理，因为并没有提供具体的相关数据库作为参考。<br>所以可以发现，污染序列数据库并<strong>不是必须的输入</strong>，seqclean基本功能就包含了对序列的剪裁。<br>依托数据库，来去污染步骤：seqclean your_EST_file -v …/UniVec/#用参数-v来指定数据库文件。</p>
<p>而对于.cln文件所包含的报告内容:</p>
<p>序列输入的名字<br><br>在清除范围内未明确的碱基的百分比<br><br>清除后5’端的坐标<br><br>清楚后3’端的坐标<br><br>序列的初始长度<br><br>被清除的碱基<br><br>清除的原因(存在污染物的名称/修剪的原因)<br></p>
<p><strong>CD-hit对处理后的EST序列去冗余</strong></p>
<p>CD-hit<br>CD-hit的作用主要用于序列的去冗余，可以根据一定条件查找相似序列，分析样品间的相似程度。</p>
<p>如果下载的是CD-hit的源码包(source)，那么在Linux下直接make就可以了。cd-hit以FASTA作为输入文件</p>
<p>#/usr/cd-hit: make</p>
<p>#/usr/cd-hit/cd-hit-est -i your_EST_clean_file -o output_EST_file -c 0.95</p>
<p>注意：cd-hit这个脚本是用来对蛋白序列进行聚类去冗余的，而cd-hit-est则是对核酸序列进行去冗余的，具体参数见文档。</p>
<p>CD-hit包中有许多脚本都非常的好用，详情见作者的github。</p>
<p>github</p>
<p><strong>关于CD-hit为什么放在序列去污染后使用，个人观点如下</strong>： CD-hit的原理主要是对所有序列进行聚类，选每组聚类中的最长序列为代表进行输出，然后给出每组聚类中每个序列相似度的参考值。由于未经处理的EST序列可能包含：接头、载体序列、污染序列等。这种情况可能会干扰CD-hit对序列进行聚类去冗余的准确度，所以选择在序列预处理后进行聚类去冗余。</p>
<p><strong>关于其它的处理软件</strong>：</p>
<p>EST-trimmer的主要作用在于去除polyA/ployT，且同时将EST序列修剪到一定的bp范围内。<br>RepeatMaster用来去除转座子等重复序列。这里个人不考虑使用，很多重复序列涉及到某些重要的功能，如果将重复序列去除，那么后期做功能注释时，会流失很多重要的信息。尽管，重复序列的存在会使序列拼接变的困难。</p>
<h2 id="五-序列拼接"><a href="#五-序列拼接" class="headerlink" title="五.序列拼接"></a>五.序列拼接</h2><p>这里采用传统的CAP3进行拼接。</p>
<p>Reference： CAP3 A DNA Sequence Assembly Program. Xiaoqiu Huang1,2 and Anup Madan3</p>
<p><a href="http://seq.cs.iastate.edu/cap3.html" target="_blank" rel="external">CAP3</a></p>
<p><div align="left"><img src="http://ppd6ez4p8.bkt.clouddn.com/CAP3.jpg" width="200"></div></p>
<p>关于CPA3的具体原理及算法这里不做阐述，整个CPA3拼接中比较关心的问题，便是reads间重叠区域的问题。也就是如图所示的第二步。</p>
<p>简单讲，CAP3设计时，是针对当时的测序仪的。为了提高拼接的精度，CAP3除了需要序列的FASTA文件外，也引进了约束文件。<br>当然如果没有约束文件，也可以进行拼接。</p>
<p>支持平台上：CAP3支持Linux、Windows(需要cygwin模拟unix环境)、Mac</p>
<p>使用：CAP3 your_EST_clean_file -p 95 -o 100 ##我这里只给一个示范参数，具体参数按个人需求。</p>
<p>输出结果：</p>
<ul>
<li>.ace格式是最终的组装结果，可以用notepad或者Consed浏览</li>
<li>.conting 包含组装后的一致性序列。.contigs.qual为对应的拼接后的质量值。</li>
<li>.singlets文件中包含未被用于拼接的reads。</li>
<li>.info为组装过程中的其它信息。</li>
</ul>
<h1 id="六-序列拼接后预处理"><a href="#六-序列拼接后预处理" class="headerlink" title="六.序列拼接后预处理"></a>六.序列拼接后预处理</h1><p>吐槽：处理之多令人发指，可能实际操作感觉还好，但是在码字中，我已经对自己写的pipline充满了怨念QAQ</p>
<p>经过CAP3拼接后，得到了contigs。利用软件，可以对contigs进行SSR及SNP等相关位点的鉴定。</p>
<p>在鉴定前，需要对contigs进行稍微的处理。将低于4条EST序列拼接的contigs去除。</p>
<p>可以自己写脚本去除，也可以用QualitySNP所带的子程序：Getalignmentinfo。</p>
<p>示范：</p>
<p>tar xzvf QualitySNP.tar.gz</p>
<p>make all</p>
<p>Getalignmentinfo your_seq.cap 4</p>
<p>Getavailcontigseq your_seq.cap</p>
<p>Getavailcontigqual your_seq.cap</p>
<p>经过这几步就处理完毕。需要注意的是: 这些脚本需要输入的不是文件的全名，而是前面CAP3输出文件的前缀文件名。</p>
<h1 id="七-拼接序列的SNP位点鉴定"><a href="#七-拼接序列的SNP位点鉴定" class="headerlink" title="七.拼接序列的SNP位点鉴定"></a>七.拼接序列的SNP位点鉴定</h1><p>那么到这里，就是重点了。</p>
<p>SNP位点的鉴定，这里以QualitySNP为示范。</p>
<p>QualitySNP your_seq.cap 2 30 0.75 0.8 0.2 0.5 2</p>
<p>QualitySNP的输出文件：</p>
<ul>
<li>realsnpinfo 包含了所有的SNP及single haplotypes</li>
<li>SNPquality 包含了所有鉴定出来SNP的信息，如置信度分数</li>
<li>availcontigwithSNP 包含了每一个contig的haplotype和SNP的信息，以及所有contig中SNP的统计信息。</li>
<li>其他的文件SNPinfo2、haplotypes、SNPdiff、allavailsnp、SNPblocks、SNPpattern这里不一一阐述。</li>
</ul>
<p>注：比较值得在意的是，QualitySNP是基于你研究的物种没有参考基因组序列的基础上进行SNP分析的，这是一个de novo的过程。这样的话，其准确度当然不如有参考的准确。</p>
<p>如果有参考基因组序列的话，可以考虑使用SOAPsnp MAQ 等</p>
<h1 id="七-SSR位点鉴定"><a href="#七-SSR位点鉴定" class="headerlink" title="七.SSR位点鉴定"></a>七.SSR位点鉴定</h1><p>关于SSR位点鉴定的工具有很多，这里以MISA为示范：</p>
<p>MISA是一个perl脚本，保证你的电脑上有perl且添加环境变量。</p>
<p><a href="http://pgrc.ipk-gatersleben.de/misa/misa.html" target="_blank" rel="external">MISA</a></p>
<p>注：</p>
<p>下载MISA时还需要一个配置文件 misa.ini。这里吐槽一下：点Download居然直接是配置文件的内容，而没有跳转到下载界面，真是无语。直接复制内容，新建文本粘贴，修改文件后缀名.txt为.ini。</p>
<p>运行MISA：misa.pl your_sequence.fasta</p>
<p>到这里，终于结束了。</p>
<p>2018/6/17 Jun</p>

            </div>

            <!-- Post Comments -->
            
    <!-- 使用 valine -->
<div id="comment">
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
<script>
    new Valine({
        el: '#comment' ,
        notify: true,
        verify: false,
        app_id: 'your appId',
        app_key: 'your appkey',
        placeholder: 'Please leave your footprints',
        pageSize: '10',
        avatar: '',
        avatar_cdn: 'https://gravatar.loli.net/avatar/'
    });
</script>
</div>
<style>
   #comment{
        padding: 2pc;
    }
</style>


        </div>
        <!-- Copyright 版权 start -->
                <div id="copyright">
            <ul>
                <li>&copy;Powered By <a href="https://hexo.io/zh-cn/" style="border-bottom: none;">hexo</a></li>
                <li>Design: <a href="http://miccall.tech " style="border-bottom: none;">miccall</a></li>
            </ul>
            
            	<span id="busuanzi_container_site_pv">2019总访问量<span id="busuanzi_value_site_pv"></span>次</span>
			
        </div>
    </div>
</body>



 	
</html>
