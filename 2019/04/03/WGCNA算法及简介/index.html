<!DOCTYPE HTML>
<html>

<head>
	<link rel="bookmark"  type="image/x-icon"  href="/img/logo_miccall.png"/>
	<link rel="shortcut icon" href="/img/logo_miccall.png">
	
			    <title>
    Jun
    </title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="/css/mic_main.css" />
    <link rel="stylesheet" href="/css/dropdownMenu.css" />
    <meta name="keywords" content="Jun-bio" />
    
    	<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
	 
    <noscript>
        <link rel="stylesheet" href="/css/noscript.css" />
    </noscript>
    <style type="text/css">
        body:before {
          content: ' ';
          position: fixed;
          top: 0;
          background: url('/img/1.jpg') center 0 no-repeat;
          right: 0;
          bottom: 0;
          left: 0;
          background-size: cover; 
        }
    </style>

			    
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script async type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


    <script src="/js/jquery.min.js"></script>
    <script src="/js/jquery.scrollex.min.js"></script>
    <script src="/js/jquery.scrolly.min.js"></script>
    <script src="/js/skel.min.js"></script>
    <script src="/js/util.js"></script>
    <script src="/js/main.js"></script>
	
	<link rel="stylesheet" href="//cdn.bootcss.com/highlight.js/9.2.0/styles/github.min.css">
	<script src="//cdn.bootcss.com/highlight.js/9.2.0/highlight.min.js"></script>
</head>
    
		
<!-- Layouts -->



<!--  代码渲染  -->
<link rel="stylesheet" href="/css/prism_coy.css" />
<link rel="stylesheet" href="/css/typo.css" />
<!-- 文章页 -->
<body class="is-loading">
    <!-- Wrapper 外包 s-->
    <div id="wrapper" class="fade-in">
        <!-- Intro 头部显示 s -->
        <!-- Intro 头部显示 e -->
        <!-- Header 头部logo start -->
        <header id="header">
    <a href="/" class="logo">Mr Jun</a>
</header>
        <!-- Nav 导航条 start -->
        <nav id="nav" class="special" >
            <ul class="menu links" >
			<!-- Homepage  主页  --> 
			<li >
	            <a href="/" rel="nofollow">主页</a>
	        </li>
			<!-- categories_name  分类   --> 
	        
	        <li class="active">
	            <a href="#s1">分类</a>
	                    <ul class="submenu">
	                        <li>
	                        <a class="category-link" href="/categories/R/">R</a></li><li><a class="category-link" href="/categories/动漫/">动漫</a></li><li><a class="category-link" href="/categories/杂记/">杂记</a></li><li><a class="category-link" href="/categories/生物信息/">生物信息</a>
	                    </ul>
	        </li>
	        
	        <!-- archives  归档   --> 
	        
	        
		        <!-- Pages 自定义   -->
		        
		        <li>
		            <a href="/about/" title="简历">
		                简历
		            </a>
		        </li>
		        
		        <li>
		            <a href="/movie/" title="新世纪补番计划">
		                新世纪补番计划
		            </a>
		        </li>
		        
		        <li>
		            <a href="/tag/" title="标签">
		                标签
		            </a>
		        </li>
		        


            </ul>
            <!-- icons 图标   -->
			<ul class="icons">
                    
                    <li>
                        <a title="github" href="https://github.com/ReJun" target="_blank" rel="noopener">
                            <i class="icon fa fa-github"></i>
                        </a>
                    </li>
                    
                    <li>
                        <a title="500px" href="http://500px.com" target="_blank" rel="noopener">
                            <i class="icon fa fa-500px"></i>
                        </a>
                    </li>
                    
			</ul>
</nav>

        <div id="main" >
            <div class ="post_page_title_img" style="height: 25rem;background-image: url(http://ppd6ez4p8.bkt.clouddn.com/WGCNA%E4%B8%80.jpg);background-position: center; background-repeat:no-repeat; background-size:cover;-moz-background-size:cover;overflow:hidden;" >
                <a href="#" style="padding: 4rem 4rem 2rem 4rem ;"><h2 >WGCNA算法及简介</h2></a>
            </div>
            <!-- Post -->
            <div class="typo" style="padding: 3rem;">
                <h1 id="Created-by-Jun-转载请注明出处：Junandhisworld-com"><a href="#Created-by-Jun-转载请注明出处：Junandhisworld-com" class="headerlink" title="Created by Jun (转载请注明出处：Junandhisworld.com)"></a>Created by Jun (转载请注明出处：Junandhisworld.com)</h1><blockquote>
<p><strong>关键词</strong>：<strong>WGCNA</strong>、<strong>共表达网络</strong>、<strong>模块</strong>、<strong>Hub基因</strong>、<strong>无尺度网络</strong></p>
</blockquote>
<h2 id="Contents"><a href="#Contents" class="headerlink" title="Contents"></a>Contents</h2><ul>
<li>WGCNA 定义及作用</li>
<li>WGCNA 适用范围</li>
<li>无尺度网络简介</li>
<li>WGCNA 原理</li>
</ul>
<h2 id="一-定义及其作用"><a href="#一-定义及其作用" class="headerlink" title="一.定义及其作用"></a>一.定义及其作用</h2><font face="微软雅黑" size="4">WGCNA译为加权基因共表达网络</font>

<p>其作用可以大体划分为三个方面：</p>
<p>其一：寻找那些彼此之间具有高相关性而被聚类划分到一起的某些基因群体。这些基因群体：cluster在WGCNA中被定义为Module，译为模块。其原理在于，高相关性的基因间被认为存在协同表达趋势，这也是共表达的来源。</p>
<p>其二：挖掘Module之中存在的Hub基因。</p>
<p>其三：探索特点Module与表型之间的关系。</p>
<h2 id="二-适用范围"><a href="#二-适用范围" class="headerlink" title="二.适用范围"></a>二.适用范围</h2><p>从数据来源讲，不管是芯片数据还是RNA-seq数据都可以作为WGCNA的输入数据。WGCNA官方所给的示范代码中，定义了两个比较重要的变量：<strong>datExpr</strong>、<strong>datTraits</strong>。</p>
<p>datExpr是用来标识基因表达矩阵的。datTraits则是用来标识样本信息的。也就是说，WGCNA可以联系样本信息或者临床信息等对所得的基因模块进行进一步的分析。当然，<strong>这里datTraits所代表的数据并不是必须的，你可以只有datExpr这个表达矩阵作为输入</strong>。</p>
<p>引自WGCNA官方:<br><img src="http://ppd6ez4p8.bkt.clouddn.com/overview-femaleLiver.png"></p>
<p>对于WGCNA来说，在样本方面，没有特别明确的硬性要求。然而，根据现有的相关文章及讨论。大多推荐样本数在<strong>15以上(包含生物学重复)，8以上(不包含生物学重复)</strong>。</p>
<p>同时建议，<strong>以标准化后的数据作为输入，而不是原始的counts矩阵</strong>。比较值得注意的是，这里提及的标准化，通常我们都会下意识认为是FPKM或者RPKM这一类标准化后的数据。其实，标准化的手段很多，不一定要依照这几种，应当结合自身数据需求来进行合适的标准化。</p>
<p>关于应用其他的标准化手段来对WGCNA数据进行处理，我会在后面讲。</p>
<h2 id="三-无尺度网络简介"><a href="#三-无尺度网络简介" class="headerlink" title="三.无尺度网络简介"></a>三.无尺度网络简介</h2><p>从特征上来讲，无尺度网络是一种其度分布(Degree Distribution)符合幂律分布(Power Law)的复杂网络.在无尺度网络中，大多数节点与其他节点只有少数的连接，而少数的节点却可以与大量的节点相连，这区别于随机网络。在随机网络中，大多数节点的连接数是差不多的，基本上连接数超出平均值或低于平均值很大的节点是不存在的。</p>
<p><img src="http://ppd6ez4p8.bkt.clouddn.com/Scale-free_network_sample.png"></p>
<p>所以两种网络从分布上看是大相径庭的。无尺度网络符合幂律分布，由逐渐递减的函数来描述。从双对数坐标系来看，则是一条直线。而随机网络则符合概率分布。</p>
<figure class="half"><br><img src="http://ppd6ez4p8.bkt.clouddn.com/lINE.jpeg" width="700" height="500"><br><img src="http://ppd6ez4p8.bkt.clouddn.com/power%20laws.jpeg" width="700" height="500"><br></figure>

<p>有人用马太效应解释幂律分布：穷着越穷，富者越富。真的是非常贴切。或者，用地位来形容的话，随机网络中大家的地位都差不多，所以随机网络是一个非常<strong>民主的国家</strong>。而无尺度网络中，大多数的节点地位都差不多，但有些节点却处于<strong>统治的地位</strong>，它们<strong>掌控</strong>着大多数的节点。</p>
<p>那么从网络的稳健性来看，无尺度网络有着它自己的<strong>软肋</strong>。</p>
<p>如果随机的攻击两种网络。那么无尺度网络会表现出很好的抵抗性或者说稳健性。而随机网络，由于节点的连接数都差不多，整个网络会损失较多的<strong>成员</strong>。无尺度网络中，由于集散节点或者叫Hub节点，由于其数目远远少于大多数的普通节点，所以面对随机性攻击，损失的则是这些普通节点。<strong>核心成员</strong>则保留下来，且整个网络不会因此瘫痪。</p>
<p>可是如果面对的是蓄意攻击，比如有针对性的攻击这些<strong>集散节点</strong>，那么整个网络可能面临着崩溃。</p>
<p>现实中有许多网络符合这种无尺度网络的特性。如：<strong>社会关系网络</strong>、<strong>蛋白互作网络</strong>、<strong>万维网</strong>等等。</p>
<p>在细胞内部就存在着这样的特性网络。如，一些转录因子便扮演着<strong>集散节点</strong>或者叫<strong>Hub节点</strong>的角色，其它的，如一些转运蛋白等扮演着<strong>普通节点</strong>的角色。当然，这并不是绝对的。</p>
<h2 id="四-WGCNA原理"><a href="#四-WGCNA原理" class="headerlink" title="四.WGCNA原理"></a>四.WGCNA原理</h2><p>前面简单的介绍了无尺度网络，这也为后面进一步理解WGCNA的原理而奠定一定的基础。</p>
<p>WGCNA的原理：可以概括分为<strong>基因聚类</strong>，<strong>关联数据分析</strong>两部分。</p>
<p>基因聚类：首先计算基因间的相关系数。通过计算相关系数，来判断两个基因间是否具有相似的表达模式，即共表达。</p>
<p><strong>重点</strong>：为了判断基因间是否具有相似的表达模式，往往需要确定一个阈值。在这个阈值以上，则认为具有表达共性。可是，这里涉及到一个问题，<strong>阈值</strong>。传统的基因共表达网络，大多设立一个直接的阈值来确定，比如将阈值设置为0.8，那么很难判断0.8和0.79间是否具有显著的差别。那么这种直接设定阈值的方式，很粗暴，如同一把刀一样，一刀下去很多重要的信息便损失了。</p>
<p>为了避免这种情况，WGCNA引入了<strong>软阈值</strong>(Soft Thresholding)。请注意，软阈值这个概念并不是WGCNA独创的。通过计算基因间相关系数取其N次幂，使基因间的连接度趋向于幂律分布，使基因之间拉开<strong>距离</strong>，如同马太效应所描述的：穷者越穷，富者越富。相关性强的越强，相关性弱的越弱，以此来符合无尺度网络的特性。</p>
<p>这样不仅避免了重要信息的流失，也使整个网络更具有生物学意义。</p>
<p>那么在通过软阈值构建网络时，另一个比较重要的部分便是基因模块的划分。WGCNA通过计算基因间的相关系数，采用<strong>层次聚类(Hierarchical Clustering)</strong>来划分基因模块。在整个层次聚类树中，通过对聚类树上不同的<strong>树枝(对应分支)</strong>修剪，从而将模块确定下来。然后用不同的颜色来代表不同的模块。</p>
<p>这样，原本几十万的基因就被划分成一个个大小不一的模块，当然你也可以看做是一种社区结构。<strong>部落</strong>、<strong>黑帮团体</strong>、<strong>小国家</strong>都行。QAQ</p>
<p>关联数据分析：那么模块划分后，整个网络就基本成型了。通过挖掘你感兴趣的模块，或是与表型关联的模块，从而缩小研究范围。那么如果没有表型数据，可以对模块进行功能注释分析。</p>
<p>其实WGCNA的作用还是比较广的。可以分析诸如：癌症相关的数据，结合病人的表型数据。不同的模块在不同的组织中相关性。植物在不同浓度的胁迫条件下，基因的表达情况。或者是某些表型的调控机理。</p>
<p>简单的来说，WGCNA的作用是非常容易理解的。那么重要的还是怎么设计一个合理的出色的实验设计。不能一味的被这些工具所牵着鼻子走。如果你不知道你的想法是否可行，那么为什么不先尝试，然后再去和别人请教讨论？学习的特点之一不就是在折腾么？</p>
<p>那么到这里WGCNA简绍也就结束了。下次我会分析WGCNA的实战，最后是WGCNA的算法细解。</p>
<p>2018/6/9 Jun</p>

            </div>

            <!-- Post Comments -->
            
    <!-- 使用 valine -->
<div id="comment">
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
<script>
    new Valine({
        el: '#comment' ,
        notify: true,
        verify: false,
        app_id: 'your appId',
        app_key: 'your appkey',
        placeholder: 'Please leave your footprints',
        pageSize: '10',
        avatar: '',
        avatar_cdn: 'https://gravatar.loli.net/avatar/'
    });
</script>
</div>
<style>
   #comment{
        padding: 2pc;
    }
</style>


        </div>
        <!-- Copyright 版权 start -->
                <div id="copyright">
            <ul>
                <li>&copy;Powered By <a href="https://hexo.io/zh-cn/" style="border-bottom: none;">hexo</a></li>
                <li>Design: <a href="http://miccall.tech " style="border-bottom: none;">miccall</a></li>
            </ul>
            
            	<span id="busuanzi_container_site_pv">2019总访问量<span id="busuanzi_value_site_pv"></span>次</span>
			
        </div>
    </div>
</body>



 	
</html>
